extends ../../layouts/default.pug
include ../../mixins/product-item.pug
//- MIXIN: Product Item (Nên tách ra file riêng mixins/product-item.pug)


block main
    .container.py-5
        //- BREADCRUMB
        nav(aria-label="breadcrumb")
            ol.breadcrumb.bg-transparent.p-0.mb-4
                li.breadcrumb-item: a.text-secondary(href="/") Trang chủ
                li.breadcrumb-item.active.text-dark(aria-current="page") Danh sách sản phẩm

        .row
            //- SIDEBAR FILTER (Trái)
            .col-12.col-lg-3.mb-4
                .sidebar
                    //- Filter: Danh mục
                    .sidebar__widget.mb-4
                        h5.sidebar__title Danh mục
                        .sidebar__content
                            ul.list-unstyled.mb-0
                                li: a.sidebar__link.active(href="/products") Tất cả sản phẩm
                                each item , index in layoutProductsCategory
                                    li: a.sidebar__link(href=`/products/${item.slug}`) #{item.title}
                                    
                    
                    //- Filter: Khoảng giá
                    -
                        const priceRanges = [
                            { label: 'Dưới 100.000đ', min: '0', max: '100000' },
                            { label: '100.000đ - 300.000đ', min: '100000', max: '300000' },
                            { label: '300.000đ - 500.000đ', min: '300000', max: '500000' },
                            { label: 'Trên 500.000đ', min: '500000', max: '' } // Max rỗng tức là vô cùng
                        ]
                    .sidebar__widget.mb-4
                        h5.sidebar__title Khoảng giá
                        .sidebar__content
                            each item in priceRanges
                                .custom-control.custom-checkbox.mb-2
                                    input.custom-control-input(
                                    type="checkbox" 
                                    name="priceRange"
                                    id=`price-${item.min}-${item.max}`
                                    value=`${item.min}-${item.max}`
                                    checked=(priceRange === `${item.min}-${item.max}`)
          
          
                                    onchange="handleChangePrice(this)")
                                    label.custom-control-label(for=`price-${item.min}-${item.max}`) #{item.label}
                    

            //- MAIN CONTENT (Phải)
            .col-12.col-lg-9
                
                //- TOOLBAR (Sắp xếp)
                .product-toolbar.d-flex.justify-content-between.align-items-center.mb-4.p-3.border.rounded
                    span.text-muted.small Hiển thị #{objPagination.start}-#{objPagination.end} trong số #{objPagination.countDocument} sản phẩm
                    
                    .d-flex.align-items-center
                        label.mr-2.mb-0.small.text-muted(for="sort") Sắp xếp:
                        select.form-control.form-control-sm.select-sort(style="width: 150px;")
                            option( selected) ---Chọn hành động---

                            option(value="priceNew_asc") Giá tăng dần
                            option(value="priceNew_desc") Giá giảm dần
                    

                //- GRID SẢN PHẨM
                .row
                    each item in records
                        +product-item(item)

                //- PAGINATION
                nav.mt-4.d-flex.justify-content-center
                    ul.pagination
                        if(objPagination.currentPage > 1)
                            li(class = "page-item disabled" page = objPagination.currentPage - 1)
                                a.page-link(href="#") <i class="fas fa-chevron-left"></i>
                        - for(let i = 1;i<=objPagination.totalPage;i++)
                            li(class=`page-item ${objPagination.currentPage == i ? "active" : ""}` page = i )
                                a.page-link(href='#' ) #{i}
                        if(objPagination.currentPage < objPagination.totalPage)
                            li(class = "page-item" page = objPagination.currentPage + 1)
                                a.page-link(href="#") <i class="fas fa-chevron-right"></i>